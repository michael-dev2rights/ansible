- name: cleanup definitions for getting rid of lambda
  block:
    - debug:
       msg: nothing to say


  always:

    # ============================================================
    - name: test state=absent (expect changed=False)
      tag: delete
      lambda:
        name="{{lambda_function_name}}"
        ec2_region='{{ec2_region}}'
        ec2_access_key='{{ec2_access_key}}'
        ec2_secret_key='{{ec2_secret_key}}'
        security_token='{{security_token}}'
        state=absent
      register: result

    - name: assert state=absent
      tag: delete
      assert:
        that:
           - 'not result|failed'
           - 'result.changed == False'
